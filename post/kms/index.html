<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script>
      if(('standalone' in window.navigator)&&window.navigator.standalone){
              var noddy,remotes=false;
              document.addEventListener('click',function(event){
                      noddy=event.target;
                      while(noddy.nodeName!=='A'&&noddy.nodeName!=='HTML') noddy=noddy.parentNode;
                      if('href' in noddy&&noddy.href.indexOf('http')!==-1&&(noddy.href.indexOf(document.location.host)!==-1||remotes)){
                              event.preventDefault();
                              document.location.href=noddy.href;
                      }
              },false);
      }
      </script>
    <link rel="apple-touch-icon" href="/images/hentai.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/hentai.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/hentai.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/hentai.png">  
    
    
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://luvsia.com/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://luvsia.com/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://luvsia.com/css/github.min.css' />
    <link rel="stylesheet" href='https://luvsia.com/css/github-style.css' />
    <link rel="stylesheet" href='https://luvsia.com/css/light.css' />
    <link rel="stylesheet" href='https://luvsia.com/css/dark.css' />
    <link rel="stylesheet" href='https://luvsia.com/css/syntax.css' />
    <title>KMS 服务端安装部署教程 - Ventus&#39; blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/%e5%9c%86%e5%bd%a2pink.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="KMS Server Installation and Deployment Tutorial" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://luvsia.com/post/kms/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="KMS 服务端安装部署教程 - Ventus&#39; blog" />
<meta name="twitter:description"
  content="KMS Server Installation and Deployment Tutorial" />
<meta name="twitter:site" content="https://luvsia.com" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://luvsia.com">


<meta property="og:type" content="article" />
<meta property="og:title" content="KMS 服务端安装部署教程 - Ventus&#39; blog">
<meta property="og:description"
  content="KMS Server Installation and Deployment Tutorial" />
<meta property="og:url" content="https://luvsia.com/post/kms/" />
<meta property="og:site_name" content="KMS 服务端安装部署教程" />
<meta property="og:image"
  content="https://luvsia.com">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2023-05-06 14:19:10 &#43;0800 &#43;0800" />


















<script async src="https://www.googletagmanager.com/gtag/js?id=G-MYYL1495Y2"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-MYYL1495Y2', { 'anonymize_ip': false });
}
</script>




<link rel="stylesheet" href="/highlight/agate.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<div id="aplayerContent">
<script src="/live2d/autoload.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
</div>


<script type="text/javascript">!function(e,t,a){function n(){c(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 500%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o(),r()}function r(){for(var e=0;e<d.length;e++)d[e].alpha<=0?(t.body.removeChild(d[e].el),d.splice(e,1)):(d[e].y--,d[e].scale+=.004,d[e].alpha-=.013,d[e].el.style.cssText="left:"+d[e].x+"px;top:"+d[e].y+"px;opacity:"+d[e].alpha+";transform:scale("+d[e].scale+","+d[e].scale+") rotate(45deg);background:"+d[e].color+";z-index:99999");requestAnimationFrame(r)}function o(){var t="function"==typeof e.onclick&&e.onclick;e.onclick=function(e){t&&t(),i(e)}}function i(e){var a=t.createElement("div");a.className="heart",d.push({el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()}),t.body.appendChild(a)}function c(e){var a=t.createElement("style");a.type="text/css";try{a.appendChild(t.createTextNode(e))}catch(t){a.styleSheet.cssText=e}t.getElementsByTagName("head")[0].appendChild(a)}function s(){return"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}var d=[];e.requestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)}}(),n()}(window,document);</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css">



<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script>
  $(document).ready(function() {
    $(document).pjax('a[target!=_blank]', '#pageContent', {fragment: '#pageContent'});
  });
</script>
</head>
<base target="_blank">

<body>
  

<style>
  .height-limitation {
    max-height: 300px;
    overflow-y: scroll;
  }

  .loader {
    border: 4px solid #f3f3f3;
    border-bottom: 4px solid var(--color-fg-muted);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
</style>

<div style="position: relative">
  <header
    class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"
  >
    <div
      class="Header-item mobile-none"
      style="margin-top: -4px; margin-bottom: -4px"
    >
      <a class="Header-link" href="https://luvsia.com" aria-label="Home">
        <svg
          class="octicon"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button
        class="Header-link btn-link js-details-target"
        type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'"
        aria-label="Search"
      >
        <svg
          height="24"
          class="octicon octicon-three-bars"
          viewBox="0 0 16 16"
          version="1.1"
          width="24"
        >
          <path
            fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"
          ></path>
        </svg>
      </button>
    </div>
    <div
      style="display: none"
      id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"
    >
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"
      >
        <div class="position-relative">
          <form
            target="_blank"
            action="https://www.google.com/search"
            accept-charset="UTF-8"
            method="get"
            autocomplete="off"
          >
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"
            >
              <input
                type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q"
                value=""
                placeholder="Search"
                autocomplete="off"
              />
              <input type="hidden" name="q" value="site:https://luvsia.com" />
              <div
                class="js-jump-to-suggestions-container jump-to-suggestions overflow-hidden position-absolute"
              >
                <div
                  id="search-progress"
                  class="d-none color-bg-primary no-underline p-2"
                  role="progress"
                  aria-selected="false"
                >
                  <div class="loader"></div>
                </div>

                <ul
                  id="jump-to-results"
                  role="listbox"
                  class="Box border-0 p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container js-active-navigation-container height-limitation"
                ></ul>
              </div>
            </label>
          </form>
        </div>
      </div>
    </div>

    <div
      class="Header-item Header-item--full flex-justify-center d-md-none position-relative"
    >
      <a class="Header-link" href="https://luvsia.com" aria-label="Home">
        <svg
          class="octicon octicon-mark-github v-align-middle"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Theme-switcher Header-item" style="margin-right: 0">
      <span
        role="button"
        class="Header-link no-select"
        onclick="switchTheme()"
        style="cursor: pointer"
        aria-label="Switch theme"
      >
        <svg
          style="fill: var(--color-profile-color-modes-toggle-moon)"
          class="no-select"
          viewBox="0 0 16 16"
          version="1.1"
          width="16"
          height="16"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z"
          ></path>
        </svg>
      </span>
    </div>
  </header>
</div>

  <div id="pageContent">
    
  
<div id="pageContent">
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://luvsia.com">
                  <img class=" avatar-user"
                    src="https://luvsia.com/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://luvsia.com">ventus</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://luvsia.com/post/kms/">KMS 服务端安装部署教程</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Sat, 06 May 2023 14:19:10 &#43;0800"
                    class="no-wrap">
                    Sat, 06 May 2023 14:19:10 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Sat, 14 Oct 2023 09:26:48 &#43;0000"
                    class="no-wrap">
                    Sat, 14 Oct 2023 09:26:48 &#43;0000</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1423 Words

                      
                      ｜
    

    
        

        
        
            <span id="busuanzi_container_value_page_pv"><i class="fa fa-search"></i>
                
                <span id="busuanzi_value_page_pv"></span>&nbsp;</span>
        
    


                      
                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/kms">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      kms
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/tools">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      tools
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p><em><strong>KMS Server Installation and Deployment Tutorial</strong></em></p>
<h2 id="关于脚本">关于脚本</h2>
<ul>
<li><em>KMS</em> 服务安装完成后会加入开机自启动。</li>
<li>默认记录日志，其日志位于 /var/log/vlmcsd.log。</li>
</ul>
<h2 id="开始部署">开始部署</h2>
<ul>
<li>使用 <em>root</em> 用户登录，运行以下命令：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget --no-check-certificate https://github.com/teddysun/across/raw/master/kms.sh <span style="color:#f92672">&amp;&amp;</span> chmod +x kms.sh <span style="color:#f92672">&amp;&amp;</span> ./kms.sh
</span></span></code></pre></div><ul>
<li>安装完成后，输入以下命令查看端口号 1688 的监听情况</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>netstat -nxtlp | grep <span style="color:#ae81ff">1688</span>
</span></span></code></pre></div><ul>
<li>返回值类似于如下这样就表示 <em>OK</em> 了：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tcp    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span> 0.0.0.0:1688   0.0.0.0:*   LISTEN   3200/vlmcsd         
</span></span><span style="display:flex;"><span>tcp    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span> :::1688        :::*        LISTEN   3200/vlmcsd 
</span></span></code></pre></div><ul>
<li>本脚本安装完成后，会将 <em>KMS</em> 服务加入开机自启动。</li>
</ul>
<h2 id="其他命令">其他命令</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>启动：/etc/init.d/kms start
</span></span><span style="display:flex;"><span>停止：/etc/init.d/kms stop
</span></span><span style="display:flex;"><span>重启：/etc/init.d/kms restart
</span></span><span style="display:flex;"><span>状态：/etc/init.d/kms status
</span></span></code></pre></div><h2 id="卸载方法">卸载方法</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./kms.sh uninstall
</span></span></code></pre></div><h2 id="激活步骤">激活步骤</h2>
<ul>
<li>使用管理员权限运行 <em>cmd</em> 查看系统版本，命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wmic os get caption
</span></span></code></pre></div><ul>
<li>使用管理员权限运行 cmd 安装从上面列表得到的 key，命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>slmgr /ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx
</span></span></code></pre></div><ul>
<li>使用管理员权限运行 cmd 将 KMS 服务器地址设置为你自己的 IP 或 域名，后面最好再加上端口号（:1688），命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>slmgr /skms Your IP or Domain:1688
</span></span></code></pre></div><ul>
<li>注意：本脚本所做的工作就是此步骤。当你的 KMS 服务出于启动状态，那么此处就可以设置为你自己的 KMS 服务器地址。
使用管理员权限运行 cmd 手动激活系统，命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>slmgr /ato
</span></span></code></pre></div><ul>
<li>关于 Office 的激活，要求必须是 VOL 版本，否则无法激活。
找到你的 Office 安装目录，32 位默认一般为 C:\Program Files (x86)\Microsoft Office\Office16
64 位默认一般为 C:\Program Files\Microsoft Office\Office16
Office16 是 Office 2016，Office15 就是 Office 2013，Office14 就是 Office 2010。
打开以上所说的目录，应该有个 OSPP.VBS 文件。
使用管理员权限运行 cmd 进入 Office 目录，命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd <span style="color:#e6db74">&#34;C:\Program Files (x86)\Microsoft Office\Office16&#34;</span>
</span></span></code></pre></div><ul>
<li>使用管理员权限运行 cmd 注册 KMS 服务器地址：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cscript ospp.vbs /sethst:Your IP or Domain
</span></span></code></pre></div><ul>
<li>使用管理员权限运行 cmd 手动激活 Office，命令如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cscript ospp.vbs /act
</span></span></code></pre></div><h3 id="主要步骤">主要步骤</h3>
<ol>
<li>设置服务 <code>slmgr -skms Your IP or Domain</code></li>
<li>安装密钥 <code>slmgr -ipk 版本对应秘钥</code></li>
<li>激活系统 <code>slmgr -ato</code></li>
</ol>
<h3 id="可用服务">可用服务</h3>
<ul>
<li><code>Your IP or Domain</code> 维护 <strong>CNAME</strong> 指向有效的服务</li>
</ul>
<ul>
<li><code>telnet Your IP or Domain 1688</code> 测试服务是否可用</li>
<li><code>tcping Your IP or Domain 1688</code></li>
</ul>
<h3 id="密钥">密钥</h3>
<p><a href="https://learn.microsoft.com/zh-cn/windows-server/get-started/kms-client-activation-keys">https://learn.microsoft.com/zh-cn/windows-server/get-started/kms-client-activation-keys</a></p>
<p><a href="https://github.com/MicrosoftDocs/windowsserverdocs/blob/main/WindowsServerDocs/get-started/kms-client-activation-keys.md">kms-client-activation-keys.md</a></p>
<h3 id="windows-serverltsc-版本">Windows Server（LTSC 版本）</h3>
<h4 id="windows-server-2022">Windows Server 2022</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2022 Datacenter</td>
<td>WX4NM-KYWYW-QJJR4-XV3QB-6VM33</td>
</tr>
<tr>
<td>Windows Server 2022 Datacenter Azure Edition</td>
<td>NTBV8-9K7Q8-V27C6-M2BTV-KHMXV</td>
</tr>
<tr>
<td>Windows Server 2022 Standard</td>
<td>VDYBN-27WPP-V4HQT-9VMD4-VMK7H</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2019">Windows Server 2019</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2019 Datacenter</td>
<td>WMDGN-G9PQG-XVVXX-R3X43-63DFG</td>
</tr>
<tr>
<td>Windows Server 2019 Standard</td>
<td>N69G4-B89J2-4G8F4-WWYCC-J464C</td>
</tr>
<tr>
<td>Windows Server 2019 Essentials</td>
<td>WVDHN-86M7X-466P6-VHXV7-YY726</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2016">Windows Server 2016</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2016 Datacenter</td>
<td>CB7KF-BWN84-R7R2Y-793K2-8XDDG</td>
</tr>
<tr>
<td>Windows Server 2016 Standard</td>
<td>WC2BQ-8NRM3-FDDYY-2BFGV-KHKQY</td>
</tr>
<tr>
<td>Windows Server 2016 Essentials</td>
<td>JCKRF-N37P4-C2D82-9YXRT-4M63B</td>
</tr>
</tbody>
</table>
<h3 id="windows-server-半年频道版本">Windows Server (半年频道版本)</h3>
<h4 id="windows-server-版本-20h2200419091903-和-1809">Windows Server 版本 20H2、2004、1909、1903 和 1809</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server Datacenter</td>
<td>6NMRW-2C8FM-D24W7-TQWMY-CWH2D</td>
</tr>
<tr>
<td>Windows Server Standard</td>
<td>N2KJX-J94YW-TQVFB-DG9YT-724CC</td>
</tr>
</tbody>
</table>
<h3 id="windows-11-和-windows-10-半年频道版本">Windows 11 和 Windows 10 (半年频道版本)</h3>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10/11 专业版</td>
<td>W269N-WFGWX-YVC9B-4J6C9-T83GX</td>
</tr>
<tr>
<td>Windows 10/11 专业版 N</td>
<td>MH37W-N47XK-V7XM9-C7227-GCQG9</td>
</tr>
<tr>
<td>Windows 10/11 专业工作站</td>
<td>NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J</td>
</tr>
<tr>
<td>Windows 10/11 专业工作站 N</td>
<td>9FNHH-K3HBT-3W4TD-6383H-6XYWF</td>
</tr>
<tr>
<td>Windows 10/11 专业教育版</td>
<td>6TP4R-GNPTD-KYYHQ-7B7DP-J447Y</td>
</tr>
<tr>
<td>Windows 10/11 专业教育版 N</td>
<td>YVWGF-BXNMC-HTQYQ-CPQ99-66QFC</td>
</tr>
<tr>
<td>Windows 10/11 教育版</td>
<td>NW6C2-QMPVW-D7KKK-3GKT6-VCFB2</td>
</tr>
<tr>
<td>Windows 10/11 教育版 N</td>
<td>2WH4N-8QGBV-H22JP-CT43Q-MDWWJ</td>
</tr>
<tr>
<td>Windows 10/11 企业版</td>
<td>NPPR9-FWDCX-D2C8J-H872K-2YT43</td>
</tr>
<tr>
<td>Windows 10/11 企业版 N</td>
<td>DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4</td>
</tr>
<tr>
<td>Windows 10/11 企业版 G</td>
<td>YYVX9-NTFWV-6MDM3-9PT4T-4M68B</td>
</tr>
<tr>
<td>Windows 10/11 企业版 G N</td>
<td>44RPN-FTY23-9VTTB-MP9BX-T84FV</td>
</tr>
</tbody>
</table>
<h3 id="windows-10-ltscltsb-版本">Windows 10 (LTSC/LTSB 版本)</h3>
<h4 id="windows-10-ltsc-2019">Windows 10 LTSC 2019</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10 企业版 LTSC 2019</td>
<td>M7XTQ-FN8P6-TTKYV-9D4CC-J462D</td>
</tr>
<tr>
<td>Windows 10 企业版 N LTSC 2019</td>
<td>92NFX-8DJQP-P6BBQ-THF9C-7CG2H</td>
</tr>
</tbody>
</table>
<h4 id="windows-10-ltsb-2016">Windows 10 LTSB 2016</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10 企业版 LTSB 2016</td>
<td>DCPHK-NFMTC-H88MJ-PFHPY-QJ4BJ</td>
</tr>
<tr>
<td>Windows 10 企业版 N LTSB 2016</td>
<td>QFFDN-GRT3P-VKWWX-X7T3R-8B639</td>
</tr>
</tbody>
</table>
<h4 id="windows-10-ltsb-2015">Windows 10 LTSB 2015</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10 企业版 2015 LTSB</td>
<td>WNMTR-4C88C-JK8YV-HQ7T2-76DF9</td>
</tr>
<tr>
<td>Windows 10 企业版 2015 LTSB N</td>
<td>2F77B-TNFGY-69QQF-B8YKP-D69TJ</td>
</tr>
</tbody>
</table>
<h3 id="早期版本的-windows-server">早期版本的 Windows Server</h3>
<h4 id="windows-server-版本-1803">Windows Server 版本 1803</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server Datacenter</td>
<td>2HXDN-KRXHB-GPYC7-YCKFJ-7FVDG</td>
</tr>
<tr>
<td>Windows Server Standard</td>
<td>PTXN8-JFHJM-4WC78-MPCBR-9W4KR</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-版本-1709">Windows Server 版本 1709</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server Datacenter</td>
<td>6Y6KB-N82V8-D8CQV-23MJW-BWTG6</td>
</tr>
<tr>
<td>Windows Server Standard</td>
<td>DPCNP-XQFKJ-BJF7R-FRC8D-GF6G4</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2012-r2">Windows Server 2012 R2</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2012 R2 Server Standard</td>
<td>D2N9P-3P6X9-2R39C-7RTCD-MDVJX</td>
</tr>
<tr>
<td>WindowsServer 2012 R2 Datacenter</td>
<td>W3GGN-FT8W3-Y4M27-J84CP-Q3VJ9</td>
</tr>
<tr>
<td>WindowsServer 2012 R2 Essentials</td>
<td>KNC87-3J2TX-XB4WP-VCPJV-M4FWM</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2012">Windows Server 2012</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2012</td>
<td>BN3D2-R7TKB-3YPBD-8DRP2-27GG4</td>
</tr>
<tr>
<td>Windows Server 2012 N</td>
<td>8N2M2-HWPGY-7PGT9-HGDD8-GVGGY</td>
</tr>
<tr>
<td>Windows Server 2012 单语言版</td>
<td>2WN2H-YGCQR-KFX6K-CD6TF-84YXQ</td>
</tr>
<tr>
<td>Windows Server 2012 特定国家/地区版</td>
<td>4K36P-JN4VD-GDC6V-KDT89-DYFKP</td>
</tr>
<tr>
<td>Windows Server 2012 Server Standard</td>
<td>XC9B7-NBPP2-83J2H-RHMBY-92BT4</td>
</tr>
<tr>
<td>Windows Server 2012 MultiPoint Standard</td>
<td>HM7DN-YVMH3-46JC3-XYTG7-CYQJJ</td>
</tr>
<tr>
<td>Windows Server 2012 MultiPoint Premium</td>
<td>XNH6W-2V9GX-RGJ4K-Y8X6F-QGJ2G</td>
</tr>
<tr>
<td>Windows Server 2012 Datacenter</td>
<td>48HP8-DN98B-MYWDG-T2DCC-8W83P</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2008-r2">Windows Server 2008 R2</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Server 2008 R2 Web 版</td>
<td>6TPJF-RBVHG-WBW2R-86QPH-6RTM4</td>
</tr>
<tr>
<td>Windows Server 2008 R2 HPC 版</td>
<td>TT8MH-CG224-D3D7Q-498W2-9QCTX</td>
</tr>
<tr>
<td>WindowsServer 2008 R2 Standard</td>
<td>YC6KT-GKW9T-YTKYR-T4X34-R7VHC</td>
</tr>
<tr>
<td>WindowsServer 2008 R2 企业版</td>
<td>489J6-VHDMP-X63PK-3K798-CPX3Y</td>
</tr>
<tr>
<td>WindowsServer 2008 R2 Datacenter</td>
<td>74YFP-3QFB3-KQT8W-PMXWJ-7M648</td>
</tr>
<tr>
<td>面向基于 Itanium 系统的 Windows Server 2008 R2</td>
<td>GT63C-RJFQ3-4GMB6-BRFB9-CB83V</td>
</tr>
</tbody>
</table>
<h4 id="windows-server-2008">Windows Server 2008</h4>
<table>
<thead>
<tr>
<th>操作系统版本</th>
<th>KMS 客户端安装密钥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Web Server 2008</td>
<td>WYR28-R7TFJ-3X2YQ-YCY4H-M249D</td>
</tr>
<tr>
<td>Windows Server 2008 Standard</td>
<td>TM24T-X9RMF-VWXK6-X8JC9-BFGM2</td>
</tr>
<tr>
<td>不带 Hyper-V 的 Windows Server 2008 Standard</td>
<td>W7VD6-7JFBR-RX26B-YKQ3Y-6FFFJ</td>
</tr>
<tr>
<td>Windows Server 2008 企业版</td>
<td>YQGMW-MPWTJ-34KDK-48M3W-X4Q6V</td>
</tr>
<tr>
<td>不带 Hyper-V 的 Windows Server 2008 企业版</td>
<td>39BXF-X8Q23-P2WWT-38T2F-G3FPG</td>
</tr>
<tr>
<td>Windows Server 2008 HPC</td>
<td>RCTX3-KWVHP-BR6TB-RB6DM-6X7HP</td>
</tr>
<tr>
<td>Windows Server 2008 Datacenter</td>
<td>7M67G-PC374-GR742-YH8V4-TCBY3</td>
</tr>
<tr>
<td>不带 Hyper-V 的 Windows Server 2008 Datacenter</td>
<td>22XQ2-VRXRG-P8D42-K34TD-G3QQC</td>
</tr>
<tr>
<td>面向基于 Itanium 系统的 Windows Server 2008</td>
<td>4DWFP-JF3DJ-B7DTH-78FJB-PDRHK</td>
</tr>
</tbody>
</table>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://luvsia.com/js/toc.js'></script>
<link rel="stylesheet" href='https://luvsia.com/css/toc.css' />

<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://luvsia.com/css/gitalk.css'>
<script src='https://luvsia.com/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    accessToken: '',
    repo: 'LuvSia',
    owner: 'ventusoon',
    admin: ['ventusoon'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>

</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://luvsia.com">
      <svg height="30" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="30">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>

    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-center mb-2 mb-lg-0">
      
    
      
      <div class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-center mb-2 mb-lg-0">
      <script>
    function siteTime() {
      var seconds = 1000;
      var minutes = seconds * 60;
      var hours = minutes * 60;
      var days = hours * 24;
      var years = days * 365;
      var today = new Date();
      var startYear = 2021;
      var startMonth = 12;
      var startDate = 31;
      var startHour = 00;
      var startMinute = 00;
      var startSecond = 00;
      var todayYear = today.getFullYear();
      var todayMonth = today.getMonth() + 1;
      var todayDate = today.getDate();
      var todayHour = today.getHours();
      var todayMinute = today.getMinutes();
      var todaySecond = today.getSeconds();
      var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
      var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
      var diff = t2 - t1;
      var diffYears = Math.floor(diff / years);
      var diffDays = Math.floor((diff / days) - diffYears * 365);
      var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
      var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                  minutes);
      var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                  diffMinutes * minutes) / seconds);
      if (startYear == todayYear) {
          
          document.getElementById("sitetime").innerHTML = " Running  " + diffDays + " d " + diffHours +
              " h " + diffMinutes + " m " + diffSeconds + " s";
      } else {
          
          document.getElementById("sitetime").innerHTML = " Running  " + diffYears + " y " + diffDays +
              " d " + diffHours + " h " + diffMinutes + " m " + diffSeconds + " s";
      }
  }
    setInterval(siteTime, 1000);</script>
    <span id="sitetime">Reloading... </span>
      </div>
      
      
      &emsp;
      <li class="mr-3 mr-lg-0">© 2023 <a href='https://luvsia.com'>Ventus</a> 丨 <a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a> 丨 <a href="https://icp.gov.moe/?keyword=20230947" target="_blank">萌ICP备20231322号</a> </li>

      
      <div class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-center mb-2 mb-lg-0">
        
      <li class="mr-3 mr-lg-0">
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="fa fa-search"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user-o"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    
</li>
      
      </div>
      
    </ul>
  </div>

  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  </div>
  <div id="aplayerContent">
    
  
<div id="aplayer"></div>
<link rel="stylesheet" href="/css/APlayer.min.css">
<script src="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script>var ap = new APlayer({
      element: document.getElementById('aplayer'),
      narrow: false,
      fixed: true,
      autoplay: true,
      mutex: true,
      lrcType: 3,
  });
    $.ajax({
    url: 'https://api.i-meto.com/meting/api?server=netease&type=playlist&id=6690262418',
    success: function (list) {
    ap.list.add(list);
    }
  });
</script>
  </div> 
</body>

<script type="application/javascript" src="https://luvsia.com/js/github-style.js"></script>

<script src="https://luvsia.com/js/mark.es6.min.js"></script>







</html>